2025-04-24 00:07:27,788 - root:setup_logging:143 - INFO - File logging (DEBUG level) activated: /radraid2/dongwoolee/VNet_LungNoduleSeg/richard/logs/train_25-04-24_00:07:27.log
2025-04-24 00:07:27,788 - root:setup_logging:149 - INFO - Console logging level set to: INFO
2025-04-24 00:07:27,789 - root:setup_logging:151 - INFO - File logging level set to: DEBUG
2025-04-24 00:07:27,789 - root:<module>:239 - INFO - Start time: 25-04-24_00:07:27
2025-04-24 00:07:27,789 - root:<module>:240 - INFO - This is a finetune script.
2025-04-24 00:07:27,800 - richard.src.utils.utils:_load_and_merge_yaml_configs:290 - INFO - Decorator loaded base config from: richard/config/finetune.yaml
2025-04-24 00:07:27,805 - richard.src.utils.utils:_load_and_merge_yaml_configs:307 - INFO - Decorator loaded config for 'model' from: richard/config/model/vnet.yaml
2025-04-24 00:07:27,812 - richard.src.utils.utils:_load_and_merge_yaml_configs:307 - INFO - Decorator loaded config for 'dataset' from: richard/config/dataset/splits_2d.yaml
2025-04-24 00:07:27,816 - richard.src.utils.utils:_load_and_merge_yaml_configs:307 - INFO - Decorator loaded config for 'dataloader' from: richard/config/dataloader/dataloader.yaml
2025-04-24 00:07:27,818 - richard.src.utils.utils:_load_and_merge_yaml_configs:307 - INFO - Decorator loaded config for 'optimizer' from: richard/config/optimizer/AdamW.yaml
2025-04-24 00:07:27,821 - richard.src.utils.utils:_load_and_merge_yaml_configs:307 - INFO - Decorator loaded config for 'scheduler' from: richard/config/scheduler/ReduceLROnPlateau.yaml
2025-04-24 00:07:27,822 - richard.src.utils.utils:wrapper:364 - INFO - Decorator successfully loaded and merged configurations.
2025-04-24 00:07:27,822 - richard.src.utils.utils:wrapper:372 - INFO - Decorator injecting loaded 'cfg' into function call.
2025-04-24 00:07:27,822 - richard.src.utils.utils:wrapper:382 - DEBUG - Decorator injected 'cfg' into function call:
 {
  "model": {
    "name": "VNet2D",
    "in_channels": 1,
    "out_channels": 1,
    "conv_kernel_size": 5,
    "conv_stride": 1,
    "conv_padding": 2,
    "conv_bn": true,
    "conv_activation_fn": null,
    "sampling_conv_kernel_size": 2,
    "sampling_conv_stride": 2,
    "sampling_conv_padding": 0,
    "sampling_conv_bn": true,
    "sampling_conv_activation_fn": null,
    "dropout_rate": 0.3
  },
  "dataset": {
    "train": {
      "image_dir": "/radraid2/dongwoolee/VNet_LungNoduleSeg/richard/data/splits/train/images_2D_0axis/",
      "mask_dir": "/radraid2/dongwoolee/VNet_LungNoduleSeg/richard/data/splits/train/masks_2D_0axis/",
      "augment": true,
      "normalize": true,
      "mean": [
        -493.0376
      ],
      "std": [
        443.1897
      ]
    },
    "val": {
      "image_dir": "/radraid2/dongwoolee/VNet_LungNoduleSeg/richard/data/splits/val/images_2D_0axis/",
      "mask_dir": "/radraid2/dongwoolee/VNet_LungNoduleSeg/richard/data/splits/val/masks_2D_0axis/",
      "augment": false,
      "normalize": true,
      "mean": [
        -493.0376
      ],
      "std": [
        443.1897
      ]
    }
  },
  "dataloader": {
    "train": {
      "batch_size": 16,
      "shuffle": true,
      "num_workers": 8
    },
    "val": {
      "batch_size": 16,
      "shuffle": false,
      "num_workers": 8
    },
    "test": {
      "batch_size": 16,
      "shuffle": false,
      "num_workers": 8
    }
  },
  "optimizer": {
    "name": "AdamW",
    "lr": 1e-05,
    "weight_decay": 0.01
  },
  "scheduler": {
    "name": "ReduceLROnPlateau",
    "factor": 0.2,
    "mode": "max",
    "patience": 5,
    "min_lr": 1e-06
  },
  "criterion": {
    "Dice": {
      "name": "DiceLoss",
      "weight": 1.0
    }
  },
  "training": {
    "num_epochs": 30,
    "batch_size": 16,
    "early_stopping_patience": 15,
    "early_stopping_min_delta": 0.0005
  },
  "checkpoint": {
    "path": "/radraid2/dongwoolee/VNet_LungNoduleSeg/richard/checkpoints/final_checkpoint_25-04-17_13:58:47.pth",
    "freeze_config": {
      "freeze": true,
      "config": {
        "init_conv": true,
        "downsample_block_1": true,
        "downsample_block_2": true,
        "downsample_block_3": true,
        "downsample_block_4": true,
        "upsample_block_1": true,
        "upsample_block_2": true,
        "upsample_block_3": false,
        "upsample_block_4": false,
        "final_conv": false
      }
    }
  }
}
2025-04-24 00:07:27,920 - root:train:29 - INFO - Using device: cuda
2025-04-24 00:07:27,921 - root:train:32 - INFO - Train function received config keys: ['model', 'dataset', 'dataloader', 'optimizer', 'scheduler', 'criterion', 'training', 'checkpoint']
2025-04-24 00:07:27,923 - root:train:36 - DEBUG - Created deep copy of config for instantiation.
2025-04-24 00:07:28,858 - root:train:53 - INFO - Loaded train dataset with 21340 samples.
2025-04-24 00:07:28,859 - root:train:54 - INFO - Loaded validation dataset with 15181 samples.
2025-04-24 00:07:28,859 - root:train:58 - INFO - Created DataLoaders.
2025-04-24 00:07:29,305 - root:train:73 - INFO - Initialized model: VNet2D
2025-04-24 00:07:29,765 - root:train:91 - INFO - Loaded model state_dict from checkpoint: /radraid2/dongwoolee/VNet_LungNoduleSeg/richard/checkpoints/final_checkpoint_25-04-17_13:58:47.pth
2025-04-24 00:07:29,766 - root:train:93 - DEBUG - Original Model Training Config: {
  "model": {
    "in_channels": 1,
    "out_channels": 1,
    "conv_kernel_size": 5,
    "conv_stride": 1,
    "conv_padding": 2,
    "conv_bn": true,
    "conv_activation_fn": null,
    "sampling_conv_kernel_size": 2,
    "sampling_conv_stride": 2,
    "sampling_conv_padding": 0,
    "sampling_conv_bn": true,
    "sampling_conv_activation_fn": null,
    "dropout_rate": 0.3
  },
  "dataset": {
    "train": {
      "image_dir": "/radraid2/dongwoolee/VNet_LungNoduleSeg/richard/data/LUNA16/train/images_2D_0axis/",
      "mask_dir": "/radraid2/dongwoolee/VNet_LungNoduleSeg/richard/data/LUNA16/train/masks_2D_0axis/",
      "augment": true,
      "normalize": true,
      "mean": [
        -593.997
      ],
      "std": [
        417.0208
      ]
    },
    "val": {
      "image_dir": "/radraid2/dongwoolee/VNet_LungNoduleSeg/richard/data/splits/val/images_2D_0axis/",
      "mask_dir": "/radraid2/dongwoolee/VNet_LungNoduleSeg/richard/data/splits/val/masks_2D_0axis/",
      "augment": false,
      "normalize": true,
      "mean": [
        -593.997
      ],
      "std": [
        417.0208
      ]
    }
  },
  "dataloader": {
    "train": {
      "batch_size": 16,
      "shuffle": true,
      "num_workers": 8
    },
    "val": {
      "batch_size": 16,
      "shuffle": false,
      "num_workers": 8
    },
    "test": {
      "batch_size": 16,
      "shuffle": false,
      "num_workers": 8
    }
  },
  "optimizer": {
    "lr": 0.0001,
    "weight_decay": 0.01
  },
  "scheduler": {
    "factor": 0.2,
    "mode": "max",
    "patience": 5,
    "min_lr": 1e-06
  },
  "criterion": {
    "Dice": {
      "name": "DiceLoss",
      "weight": 1.0
    }
  },
  "training": {
    "num_epochs": 30,
    "batch_size": 16,
    "early_stopping_patience": 15,
    "early_stopping_min_delta": 0.0005
  }
}
2025-04-24 00:07:29,767 - root:train:125 - INFO - Frozen parameters based on freeze_config: ['init_conv.conv1.weight', 'init_conv.conv1.bias', 'init_conv.bn1.weight', 'init_conv.bn1.bias', 'downsample_block_1.downsample.conv1.weight', 'downsample_block_1.downsample.conv1.bias', 'downsample_block_1.downsample.bn1.weight', 'downsample_block_1.downsample.bn1.bias', 'downsample_block_1.downsample.activation_fn.weight', 'downsample_block_1.conv_blocks.0.conv1.weight', 'downsample_block_1.conv_blocks.0.conv1.bias', 'downsample_block_1.conv_blocks.0.bn1.weight', 'downsample_block_1.conv_blocks.0.bn1.bias', 'downsample_block_1.conv_blocks.1.conv1.weight', 'downsample_block_1.conv_blocks.1.conv1.bias', 'downsample_block_1.conv_blocks.1.bn1.weight', 'downsample_block_1.conv_blocks.1.bn1.bias', 'downsample_block_2.downsample.conv1.weight', 'downsample_block_2.downsample.conv1.bias', 'downsample_block_2.downsample.bn1.weight', 'downsample_block_2.downsample.bn1.bias', 'downsample_block_2.downsample.activation_fn.weight', 'downsample_block_2.conv_blocks.0.conv1.weight', 'downsample_block_2.conv_blocks.0.conv1.bias', 'downsample_block_2.conv_blocks.0.bn1.weight', 'downsample_block_2.conv_blocks.0.bn1.bias', 'downsample_block_2.conv_blocks.1.conv1.weight', 'downsample_block_2.conv_blocks.1.conv1.bias', 'downsample_block_2.conv_blocks.1.bn1.weight', 'downsample_block_2.conv_blocks.1.bn1.bias', 'downsample_block_2.conv_blocks.2.conv1.weight', 'downsample_block_2.conv_blocks.2.conv1.bias', 'downsample_block_2.conv_blocks.2.bn1.weight', 'downsample_block_2.conv_blocks.2.bn1.bias', 'downsample_block_3.downsample.conv1.weight', 'downsample_block_3.downsample.conv1.bias', 'downsample_block_3.downsample.bn1.weight', 'downsample_block_3.downsample.bn1.bias', 'downsample_block_3.downsample.activation_fn.weight', 'downsample_block_3.conv_blocks.0.conv1.weight', 'downsample_block_3.conv_blocks.0.conv1.bias', 'downsample_block_3.conv_blocks.0.bn1.weight', 'downsample_block_3.conv_blocks.0.bn1.bias', 'downsample_block_3.conv_blocks.1.conv1.weight', 'downsample_block_3.conv_blocks.1.conv1.bias', 'downsample_block_3.conv_blocks.1.bn1.weight', 'downsample_block_3.conv_blocks.1.bn1.bias', 'downsample_block_3.conv_blocks.2.conv1.weight', 'downsample_block_3.conv_blocks.2.conv1.bias', 'downsample_block_3.conv_blocks.2.bn1.weight', 'downsample_block_3.conv_blocks.2.bn1.bias', 'downsample_block_4.downsample.conv1.weight', 'downsample_block_4.downsample.conv1.bias', 'downsample_block_4.downsample.bn1.weight', 'downsample_block_4.downsample.bn1.bias', 'downsample_block_4.downsample.activation_fn.weight', 'downsample_block_4.conv_blocks.0.conv1.weight', 'downsample_block_4.conv_blocks.0.conv1.bias', 'downsample_block_4.conv_blocks.0.bn1.weight', 'downsample_block_4.conv_blocks.0.bn1.bias', 'downsample_block_4.conv_blocks.1.conv1.weight', 'downsample_block_4.conv_blocks.1.conv1.bias', 'downsample_block_4.conv_blocks.1.bn1.weight', 'downsample_block_4.conv_blocks.1.bn1.bias', 'downsample_block_4.conv_blocks.2.conv1.weight', 'downsample_block_4.conv_blocks.2.conv1.bias', 'downsample_block_4.conv_blocks.2.bn1.weight', 'downsample_block_4.conv_blocks.2.bn1.bias', 'upsample_block_1.upsample.deconv1.weight', 'upsample_block_1.upsample.deconv1.bias', 'upsample_block_1.upsample.bn1.weight', 'upsample_block_1.upsample.bn1.bias', 'upsample_block_1.upsample.activation_fn.weight', 'upsample_block_1.conv_blocks.0.conv1.weight', 'upsample_block_1.conv_blocks.0.conv1.bias', 'upsample_block_1.conv_blocks.0.bn1.weight', 'upsample_block_1.conv_blocks.0.bn1.bias', 'upsample_block_1.conv_blocks.1.conv1.weight', 'upsample_block_1.conv_blocks.1.conv1.bias', 'upsample_block_1.conv_blocks.1.bn1.weight', 'upsample_block_1.conv_blocks.1.bn1.bias', 'upsample_block_1.conv_blocks.2.conv1.weight', 'upsample_block_1.conv_blocks.2.conv1.bias', 'upsample_block_1.conv_blocks.2.bn1.weight', 'upsample_block_1.conv_blocks.2.bn1.bias', 'upsample_block_2.upsample.deconv1.weight', 'upsample_block_2.upsample.deconv1.bias', 'upsample_block_2.upsample.bn1.weight', 'upsample_block_2.upsample.bn1.bias', 'upsample_block_2.upsample.activation_fn.weight', 'upsample_block_2.conv_blocks.0.conv1.weight', 'upsample_block_2.conv_blocks.0.conv1.bias', 'upsample_block_2.conv_blocks.0.bn1.weight', 'upsample_block_2.conv_blocks.0.bn1.bias', 'upsample_block_2.conv_blocks.1.conv1.weight', 'upsample_block_2.conv_blocks.1.conv1.bias', 'upsample_block_2.conv_blocks.1.bn1.weight', 'upsample_block_2.conv_blocks.1.bn1.bias', 'upsample_block_2.conv_blocks.2.conv1.weight', 'upsample_block_2.conv_blocks.2.conv1.bias', 'upsample_block_2.conv_blocks.2.bn1.weight', 'upsample_block_2.conv_blocks.2.bn1.bias']
2025-04-24 00:07:29,768 - root:train:148 - INFO - Initialized AdamW optimizer with params: {'lr': 1e-05, 'weight_decay': 0.01}
2025-04-24 00:07:29,768 - root:train:171 - INFO - Initialized ReduceLROnPlateau scheduler with params: {'factor': 0.2, 'mode': 'max', 'patience': 5, 'min_lr': 1e-06}
2025-04-24 00:07:29,768 - richard.src.utils.loss:__init__:202 - INFO - Initialized loss component 'Dice' (DiceLoss) with effective params: {}
2025-04-24 00:07:29,768 - richard.src.utils.loss:__init__:231 - INFO - Final combined loss weights: {'Dice': 1.0}
2025-04-24 00:07:29,768 - root:train:188 - INFO - Initialized CombinedLoss criterion.
2025-04-24 00:07:29,768 - richard.src.train.trainer:__init__:39 - INFO - Trainer initialized with optimizer: AdamW
2025-04-24 00:07:29,769 - richard.src.train.trainer:__init__:45 - INFO - Trainer initialized with scheduler: ReduceLROnPlateau
2025-04-24 00:07:29,769 - richard.src.train.trainer:__init__:53 - INFO - Trainer initialized with criterion: CombinedLoss
2025-04-24 00:07:29,769 - richard.src.train.trainer:__init__:97 - INFO - Early stopping enabled with patience: 15, min_delta: 0.0005
2025-04-24 00:07:29,769 - richard.src.train.trainer:__init__:107 - DEBUG - Initialized raw loss tracking for components: ['Dice']
2025-04-24 00:07:29,769 - root:train:209 - INFO - Starting training for 30 epochs...
2025-04-24 00:08:01,170 - richard.src.train.trainer:train:140 - DEBUG - Stepped ReduceLROnPlateau scheduler with val_dice: 0.6048
2025-04-24 00:08:01,171 - richard.src.train.trainer:train:146 - DEBUG - Epoch 1: Current learning rate: 1.00e-05
2025-04-24 00:08:01,708 - richard.src.train.trainer:save_checkpoint:395 - DEBUG - Saved new best checkpoint to /radraid2/dongwoolee/VNet_LungNoduleSeg/richard/checkpoints/best_checkpoint_25-04-24_00:07:27_epoch_1.pth with val Dice: 0.6048
2025-04-24 00:08:01,709 - richard.src.train.trainer:train:152 - DEBUG - Epoch 1 Summary:
2025-04-24 00:08:01,709 - richard.src.train.trainer:train:153 - DEBUG -   Train Loss: 0.5937, Train Dice: 0.4302
2025-04-24 00:08:01,709 - richard.src.train.trainer:train:156 - DEBUG -   Raw Train Losses: {Dice: 0.5937}
2025-04-24 00:08:01,709 - richard.src.train.trainer:train:158 - DEBUG -     Val Loss: 0.4011,   Val Dice: 0.6048
2025-04-24 00:08:01,709 - richard.src.train.trainer:train:161 - DEBUG -   Raw Val Losses: {Dice: 0.4011}
2025-04-24 00:08:01,709 - richard.src.train.trainer:train:163 - DEBUG - Best Val Loss So Far: inf, Best Val Dice So Far: 0.6048
2025-04-24 00:08:35,727 - richard.src.train.trainer:train:140 - DEBUG - Stepped ReduceLROnPlateau scheduler with val_dice: 0.6196
2025-04-24 00:08:35,727 - richard.src.train.trainer:train:146 - DEBUG - Epoch 2: Current learning rate: 1.00e-05
2025-04-24 00:08:36,242 - richard.src.train.trainer:save_checkpoint:395 - DEBUG - Saved new best checkpoint to /radraid2/dongwoolee/VNet_LungNoduleSeg/richard/checkpoints/best_checkpoint_25-04-24_00:07:27_epoch_2.pth with val Dice: 0.6196
2025-04-24 00:08:36,275 - richard.src.train.trainer:save_checkpoint:405 - DEBUG - Removed previous best checkpoint: /radraid2/dongwoolee/VNet_LungNoduleSeg/richard/checkpoints/best_checkpoint_25-04-24_00:07:27_epoch_1.pth
2025-04-24 00:08:36,276 - richard.src.train.trainer:train:152 - DEBUG - Epoch 2 Summary:
2025-04-24 00:08:36,277 - richard.src.train.trainer:train:153 - DEBUG -   Train Loss: 0.4305, Train Dice: 0.5973
2025-04-24 00:08:36,277 - richard.src.train.trainer:train:156 - DEBUG -   Raw Train Losses: {Dice: 0.4305}
2025-04-24 00:08:36,277 - richard.src.train.trainer:train:158 - DEBUG -     Val Loss: 0.3835,   Val Dice: 0.6196
2025-04-24 00:08:36,277 - richard.src.train.trainer:train:161 - DEBUG -   Raw Val Losses: {Dice: 0.3835}
2025-04-24 00:08:36,277 - richard.src.train.trainer:train:163 - DEBUG - Best Val Loss So Far: 0.4011, Best Val Dice So Far: 0.6196
2025-04-24 00:09:12,452 - richard.src.train.trainer:train:140 - DEBUG - Stepped ReduceLROnPlateau scheduler with val_dice: 0.6212
2025-04-24 00:09:12,452 - richard.src.train.trainer:train:146 - DEBUG - Epoch 3: Current learning rate: 1.00e-05
2025-04-24 00:09:12,974 - richard.src.train.trainer:save_checkpoint:395 - DEBUG - Saved new best checkpoint to /radraid2/dongwoolee/VNet_LungNoduleSeg/richard/checkpoints/best_checkpoint_25-04-24_00:07:27_epoch_3.pth with val Dice: 0.6212
2025-04-24 00:09:12,993 - richard.src.train.trainer:save_checkpoint:405 - DEBUG - Removed previous best checkpoint: /radraid2/dongwoolee/VNet_LungNoduleSeg/richard/checkpoints/best_checkpoint_25-04-24_00:07:27_epoch_2.pth
2025-04-24 00:09:12,994 - richard.src.train.trainer:train:152 - DEBUG - Epoch 3 Summary:
2025-04-24 00:09:12,995 - richard.src.train.trainer:train:153 - DEBUG -   Train Loss: 0.3940, Train Dice: 0.6283
2025-04-24 00:09:12,995 - richard.src.train.trainer:train:156 - DEBUG -   Raw Train Losses: {Dice: 0.3940}
2025-04-24 00:09:12,995 - richard.src.train.trainer:train:158 - DEBUG -     Val Loss: 0.3804,   Val Dice: 0.6212
2025-04-24 00:09:12,995 - richard.src.train.trainer:train:161 - DEBUG -   Raw Val Losses: {Dice: 0.3804}
2025-04-24 00:09:12,995 - richard.src.train.trainer:train:163 - DEBUG - Best Val Loss So Far: 0.3835, Best Val Dice So Far: 0.6212
2025-04-24 00:09:49,817 - richard.src.train.trainer:train:140 - DEBUG - Stepped ReduceLROnPlateau scheduler with val_dice: 0.6345
2025-04-24 00:09:49,817 - richard.src.train.trainer:train:146 - DEBUG - Epoch 4: Current learning rate: 1.00e-05
2025-04-24 00:09:50,338 - richard.src.train.trainer:save_checkpoint:395 - DEBUG - Saved new best checkpoint to /radraid2/dongwoolee/VNet_LungNoduleSeg/richard/checkpoints/best_checkpoint_25-04-24_00:07:27_epoch_4.pth with val Dice: 0.6345
2025-04-24 00:09:50,370 - richard.src.train.trainer:save_checkpoint:405 - DEBUG - Removed previous best checkpoint: /radraid2/dongwoolee/VNet_LungNoduleSeg/richard/checkpoints/best_checkpoint_25-04-24_00:07:27_epoch_3.pth
2025-04-24 00:09:50,370 - richard.src.train.trainer:train:152 - DEBUG - Epoch 4 Summary:
2025-04-24 00:09:50,371 - richard.src.train.trainer:train:153 - DEBUG -   Train Loss: 0.3737, Train Dice: 0.6455
2025-04-24 00:09:50,371 - richard.src.train.trainer:train:156 - DEBUG -   Raw Train Losses: {Dice: 0.3737}
2025-04-24 00:09:50,371 - richard.src.train.trainer:train:158 - DEBUG -     Val Loss: 0.3671,   Val Dice: 0.6345
2025-04-24 00:09:50,371 - richard.src.train.trainer:train:161 - DEBUG -   Raw Val Losses: {Dice: 0.3671}
2025-04-24 00:09:50,371 - richard.src.train.trainer:train:163 - DEBUG - Best Val Loss So Far: 0.3804, Best Val Dice So Far: 0.6345
2025-04-24 00:10:27,422 - richard.src.train.trainer:train:132 - DEBUG - Epoch 5: No improvement in val_dice for 1 epoch(s). Patience: 15
2025-04-24 00:10:27,422 - richard.src.train.trainer:train:140 - DEBUG - Stepped ReduceLROnPlateau scheduler with val_dice: 0.6289
2025-04-24 00:10:27,422 - richard.src.train.trainer:train:146 - DEBUG - Epoch 5: Current learning rate: 1.00e-05
2025-04-24 00:10:27,422 - richard.src.train.trainer:save_checkpoint:409 - DEBUG - Epoch 5: Val Dice 0.6289 did not improve over best 0.6345
2025-04-24 00:10:27,422 - richard.src.train.trainer:train:152 - DEBUG - Epoch 5 Summary:
2025-04-24 00:10:27,422 - richard.src.train.trainer:train:153 - DEBUG -   Train Loss: 0.3553, Train Dice: 0.6603
2025-04-24 00:10:27,422 - richard.src.train.trainer:train:156 - DEBUG -   Raw Train Losses: {Dice: 0.3553}
2025-04-24 00:10:27,422 - richard.src.train.trainer:train:158 - DEBUG -     Val Loss: 0.3722,   Val Dice: 0.6289
2025-04-24 00:10:27,422 - richard.src.train.trainer:train:161 - DEBUG -   Raw Val Losses: {Dice: 0.3722}
2025-04-24 00:10:27,423 - richard.src.train.trainer:train:163 - DEBUG - Best Val Loss So Far: 0.3671, Best Val Dice So Far: 0.6345
2025-04-24 00:11:02,816 - richard.src.train.trainer:train:132 - DEBUG - Epoch 6: No improvement in val_dice for 2 epoch(s). Patience: 15
2025-04-24 00:11:02,816 - richard.src.train.trainer:train:140 - DEBUG - Stepped ReduceLROnPlateau scheduler with val_dice: 0.6264
2025-04-24 00:11:02,816 - richard.src.train.trainer:train:146 - DEBUG - Epoch 6: Current learning rate: 1.00e-05
2025-04-24 00:11:02,817 - richard.src.train.trainer:save_checkpoint:409 - DEBUG - Epoch 6: Val Dice 0.6264 did not improve over best 0.6345
2025-04-24 00:11:02,817 - richard.src.train.trainer:train:152 - DEBUG - Epoch 6 Summary:
2025-04-24 00:11:02,817 - richard.src.train.trainer:train:153 - DEBUG -   Train Loss: 0.3462, Train Dice: 0.6676
2025-04-24 00:11:02,817 - richard.src.train.trainer:train:156 - DEBUG -   Raw Train Losses: {Dice: 0.3462}
2025-04-24 00:11:02,817 - richard.src.train.trainer:train:158 - DEBUG -     Val Loss: 0.3744,   Val Dice: 0.6264
2025-04-24 00:11:02,817 - richard.src.train.trainer:train:161 - DEBUG -   Raw Val Losses: {Dice: 0.3744}
2025-04-24 00:11:02,817 - richard.src.train.trainer:train:163 - DEBUG - Best Val Loss So Far: 0.3671, Best Val Dice So Far: 0.6345
2025-04-24 00:11:39,024 - richard.src.train.trainer:train:132 - DEBUG - Epoch 7: No improvement in val_dice for 3 epoch(s). Patience: 15
2025-04-24 00:11:39,025 - richard.src.train.trainer:train:140 - DEBUG - Stepped ReduceLROnPlateau scheduler with val_dice: 0.6263
2025-04-24 00:11:39,025 - richard.src.train.trainer:train:146 - DEBUG - Epoch 7: Current learning rate: 1.00e-05
2025-04-24 00:11:39,025 - richard.src.train.trainer:save_checkpoint:409 - DEBUG - Epoch 7: Val Dice 0.6263 did not improve over best 0.6345
2025-04-24 00:11:39,025 - richard.src.train.trainer:train:152 - DEBUG - Epoch 7 Summary:
2025-04-24 00:11:39,025 - richard.src.train.trainer:train:153 - DEBUG -   Train Loss: 0.3381, Train Dice: 0.6740
2025-04-24 00:11:39,025 - richard.src.train.trainer:train:156 - DEBUG -   Raw Train Losses: {Dice: 0.3381}
2025-04-24 00:11:39,026 - richard.src.train.trainer:train:158 - DEBUG -     Val Loss: 0.3745,   Val Dice: 0.6263
2025-04-24 00:11:39,026 - richard.src.train.trainer:train:161 - DEBUG -   Raw Val Losses: {Dice: 0.3745}
2025-04-24 00:11:39,026 - richard.src.train.trainer:train:163 - DEBUG - Best Val Loss So Far: 0.3671, Best Val Dice So Far: 0.6345
2025-04-24 00:12:13,858 - richard.src.train.trainer:train:132 - DEBUG - Epoch 8: No improvement in val_dice for 4 epoch(s). Patience: 15
2025-04-24 00:12:13,859 - richard.src.train.trainer:train:140 - DEBUG - Stepped ReduceLROnPlateau scheduler with val_dice: 0.6295
2025-04-24 00:12:13,859 - richard.src.train.trainer:train:146 - DEBUG - Epoch 8: Current learning rate: 1.00e-05
2025-04-24 00:12:13,859 - richard.src.train.trainer:save_checkpoint:409 - DEBUG - Epoch 8: Val Dice 0.6295 did not improve over best 0.6345
2025-04-24 00:12:13,859 - richard.src.train.trainer:train:152 - DEBUG - Epoch 8 Summary:
2025-04-24 00:12:13,859 - richard.src.train.trainer:train:153 - DEBUG -   Train Loss: 0.3312, Train Dice: 0.6800
2025-04-24 00:12:13,859 - richard.src.train.trainer:train:156 - DEBUG -   Raw Train Losses: {Dice: 0.3312}
2025-04-24 00:12:13,859 - richard.src.train.trainer:train:158 - DEBUG -     Val Loss: 0.3711,   Val Dice: 0.6295
2025-04-24 00:12:13,859 - richard.src.train.trainer:train:161 - DEBUG -   Raw Val Losses: {Dice: 0.3711}
2025-04-24 00:12:13,859 - richard.src.train.trainer:train:163 - DEBUG - Best Val Loss So Far: 0.3671, Best Val Dice So Far: 0.6345
2025-04-24 00:12:48,905 - richard.src.train.trainer:train:132 - DEBUG - Epoch 9: No improvement in val_dice for 5 epoch(s). Patience: 15
2025-04-24 00:12:48,906 - richard.src.train.trainer:train:140 - DEBUG - Stepped ReduceLROnPlateau scheduler with val_dice: 0.6233
2025-04-24 00:12:48,906 - richard.src.train.trainer:train:146 - DEBUG - Epoch 9: Current learning rate: 1.00e-05
2025-04-24 00:12:48,906 - richard.src.train.trainer:save_checkpoint:409 - DEBUG - Epoch 9: Val Dice 0.6233 did not improve over best 0.6345
2025-04-24 00:12:48,906 - richard.src.train.trainer:train:152 - DEBUG - Epoch 9 Summary:
2025-04-24 00:12:48,906 - richard.src.train.trainer:train:153 - DEBUG -   Train Loss: 0.3251, Train Dice: 0.6848
2025-04-24 00:12:48,906 - richard.src.train.trainer:train:156 - DEBUG -   Raw Train Losses: {Dice: 0.3251}
2025-04-24 00:12:48,907 - richard.src.train.trainer:train:158 - DEBUG -     Val Loss: 0.3773,   Val Dice: 0.6233
2025-04-24 00:12:48,907 - richard.src.train.trainer:train:161 - DEBUG -   Raw Val Losses: {Dice: 0.3773}
2025-04-24 00:12:48,907 - richard.src.train.trainer:train:163 - DEBUG - Best Val Loss So Far: 0.3671, Best Val Dice So Far: 0.6345
2025-04-24 00:13:25,771 - richard.src.train.trainer:train:140 - DEBUG - Stepped ReduceLROnPlateau scheduler with val_dice: 0.6418
2025-04-24 00:13:25,771 - richard.src.train.trainer:train:146 - DEBUG - Epoch 10: Current learning rate: 1.00e-05
2025-04-24 00:13:26,315 - richard.src.train.trainer:save_checkpoint:395 - DEBUG - Saved new best checkpoint to /radraid2/dongwoolee/VNet_LungNoduleSeg/richard/checkpoints/best_checkpoint_25-04-24_00:07:27_epoch_10.pth with val Dice: 0.6418
2025-04-24 00:13:26,347 - richard.src.train.trainer:save_checkpoint:405 - DEBUG - Removed previous best checkpoint: /radraid2/dongwoolee/VNet_LungNoduleSeg/richard/checkpoints/best_checkpoint_25-04-24_00:07:27_epoch_4.pth
2025-04-24 00:13:26,348 - richard.src.train.trainer:train:152 - DEBUG - Epoch 10 Summary:
2025-04-24 00:13:26,348 - richard.src.train.trainer:train:153 - DEBUG -   Train Loss: 0.3227, Train Dice: 0.6867
2025-04-24 00:13:26,348 - richard.src.train.trainer:train:156 - DEBUG -   Raw Train Losses: {Dice: 0.3227}
2025-04-24 00:13:26,349 - richard.src.train.trainer:train:158 - DEBUG -     Val Loss: 0.3586,   Val Dice: 0.6418
2025-04-24 00:13:26,349 - richard.src.train.trainer:train:161 - DEBUG -   Raw Val Losses: {Dice: 0.3586}
2025-04-24 00:13:26,349 - richard.src.train.trainer:train:163 - DEBUG - Best Val Loss So Far: 0.3671, Best Val Dice So Far: 0.6418
2025-04-24 00:14:00,143 - richard.src.train.trainer:train:132 - DEBUG - Epoch 11: No improvement in val_dice for 1 epoch(s). Patience: 15
2025-04-24 00:14:00,143 - richard.src.train.trainer:train:140 - DEBUG - Stepped ReduceLROnPlateau scheduler with val_dice: 0.6276
2025-04-24 00:14:00,143 - richard.src.train.trainer:train:146 - DEBUG - Epoch 11: Current learning rate: 1.00e-05
2025-04-24 00:14:00,143 - richard.src.train.trainer:save_checkpoint:409 - DEBUG - Epoch 11: Val Dice 0.6276 did not improve over best 0.6418
2025-04-24 00:14:00,143 - richard.src.train.trainer:train:152 - DEBUG - Epoch 11 Summary:
2025-04-24 00:14:00,143 - richard.src.train.trainer:train:153 - DEBUG -   Train Loss: 0.3170, Train Dice: 0.6917
2025-04-24 00:14:00,143 - richard.src.train.trainer:train:156 - DEBUG -   Raw Train Losses: {Dice: 0.3170}
2025-04-24 00:14:00,143 - richard.src.train.trainer:train:158 - DEBUG -     Val Loss: 0.3726,   Val Dice: 0.6276
2025-04-24 00:14:00,143 - richard.src.train.trainer:train:161 - DEBUG -   Raw Val Losses: {Dice: 0.3726}
2025-04-24 00:14:00,143 - richard.src.train.trainer:train:163 - DEBUG - Best Val Loss So Far: 0.3586, Best Val Dice So Far: 0.6418
2025-04-24 00:14:34,529 - richard.src.train.trainer:train:132 - DEBUG - Epoch 12: No improvement in val_dice for 2 epoch(s). Patience: 15
2025-04-24 00:14:34,529 - richard.src.train.trainer:train:140 - DEBUG - Stepped ReduceLROnPlateau scheduler with val_dice: 0.6316
2025-04-24 00:14:34,530 - richard.src.train.trainer:train:146 - DEBUG - Epoch 12: Current learning rate: 1.00e-05
2025-04-24 00:14:34,530 - richard.src.train.trainer:save_checkpoint:409 - DEBUG - Epoch 12: Val Dice 0.6316 did not improve over best 0.6418
2025-04-24 00:14:34,530 - richard.src.train.trainer:train:152 - DEBUG - Epoch 12 Summary:
2025-04-24 00:14:34,530 - richard.src.train.trainer:train:153 - DEBUG -   Train Loss: 0.3142, Train Dice: 0.6939
2025-04-24 00:14:34,530 - richard.src.train.trainer:train:156 - DEBUG -   Raw Train Losses: {Dice: 0.3142}
2025-04-24 00:14:34,530 - richard.src.train.trainer:train:158 - DEBUG -     Val Loss: 0.3687,   Val Dice: 0.6316
2025-04-24 00:14:34,530 - richard.src.train.trainer:train:161 - DEBUG -   Raw Val Losses: {Dice: 0.3687}
2025-04-24 00:14:34,530 - richard.src.train.trainer:train:163 - DEBUG - Best Val Loss So Far: 0.3586, Best Val Dice So Far: 0.6418
2025-04-24 00:15:12,106 - richard.src.train.trainer:train:132 - DEBUG - Epoch 13: No improvement in val_dice for 3 epoch(s). Patience: 15
2025-04-24 00:15:12,107 - richard.src.train.trainer:train:140 - DEBUG - Stepped ReduceLROnPlateau scheduler with val_dice: 0.6267
2025-04-24 00:15:12,107 - richard.src.train.trainer:train:146 - DEBUG - Epoch 13: Current learning rate: 1.00e-05
2025-04-24 00:15:12,107 - richard.src.train.trainer:save_checkpoint:409 - DEBUG - Epoch 13: Val Dice 0.6267 did not improve over best 0.6418
2025-04-24 00:15:12,107 - richard.src.train.trainer:train:152 - DEBUG - Epoch 13 Summary:
2025-04-24 00:15:12,107 - richard.src.train.trainer:train:153 - DEBUG -   Train Loss: 0.3108, Train Dice: 0.6967
2025-04-24 00:15:12,107 - richard.src.train.trainer:train:156 - DEBUG -   Raw Train Losses: {Dice: 0.3108}
2025-04-24 00:15:12,107 - richard.src.train.trainer:train:158 - DEBUG -     Val Loss: 0.3737,   Val Dice: 0.6267
2025-04-24 00:15:12,107 - richard.src.train.trainer:train:161 - DEBUG -   Raw Val Losses: {Dice: 0.3737}
2025-04-24 00:15:12,107 - richard.src.train.trainer:train:163 - DEBUG - Best Val Loss So Far: 0.3586, Best Val Dice So Far: 0.6418
2025-04-24 00:15:49,735 - richard.src.train.trainer:train:140 - DEBUG - Stepped ReduceLROnPlateau scheduler with val_dice: 0.6529
2025-04-24 00:15:49,736 - richard.src.train.trainer:train:146 - DEBUG - Epoch 14: Current learning rate: 1.00e-05
2025-04-24 00:15:50,264 - richard.src.train.trainer:save_checkpoint:395 - DEBUG - Saved new best checkpoint to /radraid2/dongwoolee/VNet_LungNoduleSeg/richard/checkpoints/best_checkpoint_25-04-24_00:07:27_epoch_14.pth with val Dice: 0.6529
2025-04-24 00:15:50,305 - richard.src.train.trainer:save_checkpoint:405 - DEBUG - Removed previous best checkpoint: /radraid2/dongwoolee/VNet_LungNoduleSeg/richard/checkpoints/best_checkpoint_25-04-24_00:07:27_epoch_10.pth
2025-04-24 00:15:50,306 - richard.src.train.trainer:train:152 - DEBUG - Epoch 14 Summary:
2025-04-24 00:15:50,306 - richard.src.train.trainer:train:153 - DEBUG -   Train Loss: 0.3043, Train Dice: 0.7025
2025-04-24 00:15:50,306 - richard.src.train.trainer:train:156 - DEBUG -   Raw Train Losses: {Dice: 0.3043}
2025-04-24 00:15:50,306 - richard.src.train.trainer:train:158 - DEBUG -     Val Loss: 0.3479,   Val Dice: 0.6529
2025-04-24 00:15:50,307 - richard.src.train.trainer:train:161 - DEBUG -   Raw Val Losses: {Dice: 0.3479}
2025-04-24 00:15:50,307 - richard.src.train.trainer:train:163 - DEBUG - Best Val Loss So Far: 0.3586, Best Val Dice So Far: 0.6529
2025-04-24 00:16:26,515 - richard.src.train.trainer:train:132 - DEBUG - Epoch 15: No improvement in val_dice for 1 epoch(s). Patience: 15
2025-04-24 00:16:26,516 - richard.src.train.trainer:train:140 - DEBUG - Stepped ReduceLROnPlateau scheduler with val_dice: 0.6534
2025-04-24 00:16:26,516 - richard.src.train.trainer:train:146 - DEBUG - Epoch 15: Current learning rate: 1.00e-05
2025-04-24 00:16:27,086 - richard.src.train.trainer:save_checkpoint:395 - DEBUG - Saved new best checkpoint to /radraid2/dongwoolee/VNet_LungNoduleSeg/richard/checkpoints/best_checkpoint_25-04-24_00:07:27_epoch_15.pth with val Dice: 0.6534
2025-04-24 00:16:27,123 - richard.src.train.trainer:save_checkpoint:405 - DEBUG - Removed previous best checkpoint: /radraid2/dongwoolee/VNet_LungNoduleSeg/richard/checkpoints/best_checkpoint_25-04-24_00:07:27_epoch_14.pth
2025-04-24 00:16:27,124 - richard.src.train.trainer:train:152 - DEBUG - Epoch 15 Summary:
2025-04-24 00:16:27,124 - richard.src.train.trainer:train:153 - DEBUG -   Train Loss: 0.3031, Train Dice: 0.7038
2025-04-24 00:16:27,124 - richard.src.train.trainer:train:156 - DEBUG -   Raw Train Losses: {Dice: 0.3031}
2025-04-24 00:16:27,124 - richard.src.train.trainer:train:158 - DEBUG -     Val Loss: 0.3473,   Val Dice: 0.6534
2025-04-24 00:16:27,124 - richard.src.train.trainer:train:161 - DEBUG -   Raw Val Losses: {Dice: 0.3473}
2025-04-24 00:16:27,124 - richard.src.train.trainer:train:163 - DEBUG - Best Val Loss So Far: 0.3479, Best Val Dice So Far: 0.6534
2025-04-24 00:17:01,874 - richard.src.train.trainer:train:140 - DEBUG - Stepped ReduceLROnPlateau scheduler with val_dice: 0.6631
2025-04-24 00:17:01,875 - richard.src.train.trainer:train:146 - DEBUG - Epoch 16: Current learning rate: 1.00e-05
2025-04-24 00:17:02,398 - richard.src.train.trainer:save_checkpoint:395 - DEBUG - Saved new best checkpoint to /radraid2/dongwoolee/VNet_LungNoduleSeg/richard/checkpoints/best_checkpoint_25-04-24_00:07:27_epoch_16.pth with val Dice: 0.6631
2025-04-24 00:17:02,433 - richard.src.train.trainer:save_checkpoint:405 - DEBUG - Removed previous best checkpoint: /radraid2/dongwoolee/VNet_LungNoduleSeg/richard/checkpoints/best_checkpoint_25-04-24_00:07:27_epoch_15.pth
2025-04-24 00:17:02,436 - richard.src.train.trainer:train:152 - DEBUG - Epoch 16 Summary:
2025-04-24 00:17:02,437 - richard.src.train.trainer:train:153 - DEBUG -   Train Loss: 0.3005, Train Dice: 0.7057
2025-04-24 00:17:02,437 - richard.src.train.trainer:train:156 - DEBUG -   Raw Train Losses: {Dice: 0.3005}
2025-04-24 00:17:02,437 - richard.src.train.trainer:train:158 - DEBUG -     Val Loss: 0.3375,   Val Dice: 0.6631
2025-04-24 00:17:02,437 - richard.src.train.trainer:train:161 - DEBUG -   Raw Val Losses: {Dice: 0.3375}
2025-04-24 00:17:02,437 - richard.src.train.trainer:train:163 - DEBUG - Best Val Loss So Far: 0.3473, Best Val Dice So Far: 0.6631
2025-04-24 00:17:38,582 - richard.src.train.trainer:train:132 - DEBUG - Epoch 17: No improvement in val_dice for 1 epoch(s). Patience: 15
2025-04-24 00:17:38,590 - richard.src.train.trainer:train:140 - DEBUG - Stepped ReduceLROnPlateau scheduler with val_dice: 0.6574
2025-04-24 00:17:38,591 - richard.src.train.trainer:train:146 - DEBUG - Epoch 17: Current learning rate: 1.00e-05
2025-04-24 00:17:38,591 - richard.src.train.trainer:save_checkpoint:409 - DEBUG - Epoch 17: Val Dice 0.6574 did not improve over best 0.6631
2025-04-24 00:17:38,591 - richard.src.train.trainer:train:152 - DEBUG - Epoch 17 Summary:
2025-04-24 00:17:38,591 - richard.src.train.trainer:train:153 - DEBUG -   Train Loss: 0.3015, Train Dice: 0.7049
2025-04-24 00:17:38,591 - richard.src.train.trainer:train:156 - DEBUG -   Raw Train Losses: {Dice: 0.3015}
2025-04-24 00:17:38,591 - richard.src.train.trainer:train:158 - DEBUG -     Val Loss: 0.3432,   Val Dice: 0.6574
2025-04-24 00:17:38,591 - richard.src.train.trainer:train:161 - DEBUG -   Raw Val Losses: {Dice: 0.3432}
2025-04-24 00:17:38,591 - richard.src.train.trainer:train:163 - DEBUG - Best Val Loss So Far: 0.3375, Best Val Dice So Far: 0.6631
2025-04-24 00:18:15,657 - richard.src.train.trainer:train:132 - DEBUG - Epoch 18: No improvement in val_dice for 2 epoch(s). Patience: 15
2025-04-24 00:18:15,657 - richard.src.train.trainer:train:140 - DEBUG - Stepped ReduceLROnPlateau scheduler with val_dice: 0.6533
2025-04-24 00:18:15,657 - richard.src.train.trainer:train:146 - DEBUG - Epoch 18: Current learning rate: 1.00e-05
2025-04-24 00:18:15,658 - richard.src.train.trainer:save_checkpoint:409 - DEBUG - Epoch 18: Val Dice 0.6533 did not improve over best 0.6631
2025-04-24 00:18:15,658 - richard.src.train.trainer:train:152 - DEBUG - Epoch 18 Summary:
2025-04-24 00:18:15,658 - richard.src.train.trainer:train:153 - DEBUG -   Train Loss: 0.2980, Train Dice: 0.7082
2025-04-24 00:18:15,658 - richard.src.train.trainer:train:156 - DEBUG -   Raw Train Losses: {Dice: 0.2980}
2025-04-24 00:18:15,658 - richard.src.train.trainer:train:158 - DEBUG -     Val Loss: 0.3474,   Val Dice: 0.6533
2025-04-24 00:18:15,658 - richard.src.train.trainer:train:161 - DEBUG -   Raw Val Losses: {Dice: 0.3474}
2025-04-24 00:18:15,658 - richard.src.train.trainer:train:163 - DEBUG - Best Val Loss So Far: 0.3375, Best Val Dice So Far: 0.6631
2025-04-24 00:18:53,568 - richard.src.train.trainer:train:132 - DEBUG - Epoch 19: No improvement in val_dice for 3 epoch(s). Patience: 15
2025-04-24 00:18:53,571 - richard.src.train.trainer:train:140 - DEBUG - Stepped ReduceLROnPlateau scheduler with val_dice: 0.6567
2025-04-24 00:18:53,571 - richard.src.train.trainer:train:146 - DEBUG - Epoch 19: Current learning rate: 1.00e-05
2025-04-24 00:18:53,573 - richard.src.train.trainer:save_checkpoint:409 - DEBUG - Epoch 19: Val Dice 0.6567 did not improve over best 0.6631
2025-04-24 00:18:53,573 - richard.src.train.trainer:train:152 - DEBUG - Epoch 19 Summary:
2025-04-24 00:18:53,573 - richard.src.train.trainer:train:153 - DEBUG -   Train Loss: 0.2917, Train Dice: 0.7138
2025-04-24 00:18:53,573 - richard.src.train.trainer:train:156 - DEBUG -   Raw Train Losses: {Dice: 0.2917}
2025-04-24 00:18:53,573 - richard.src.train.trainer:train:158 - DEBUG -     Val Loss: 0.3438,   Val Dice: 0.6567
2025-04-24 00:18:53,573 - richard.src.train.trainer:train:161 - DEBUG -   Raw Val Losses: {Dice: 0.3438}
2025-04-24 00:18:53,573 - richard.src.train.trainer:train:163 - DEBUG - Best Val Loss So Far: 0.3375, Best Val Dice So Far: 0.6631
2025-04-24 00:19:32,574 - richard.src.train.trainer:train:132 - DEBUG - Epoch 20: No improvement in val_dice for 4 epoch(s). Patience: 15
2025-04-24 00:19:32,574 - richard.src.train.trainer:train:140 - DEBUG - Stepped ReduceLROnPlateau scheduler with val_dice: 0.6603
2025-04-24 00:19:32,574 - richard.src.train.trainer:train:146 - DEBUG - Epoch 20: Current learning rate: 1.00e-05
2025-04-24 00:19:32,574 - richard.src.train.trainer:save_checkpoint:409 - DEBUG - Epoch 20: Val Dice 0.6603 did not improve over best 0.6631
2025-04-24 00:19:32,574 - richard.src.train.trainer:train:152 - DEBUG - Epoch 20 Summary:
2025-04-24 00:19:32,574 - richard.src.train.trainer:train:153 - DEBUG -   Train Loss: 0.2928, Train Dice: 0.7128
2025-04-24 00:19:32,575 - richard.src.train.trainer:train:156 - DEBUG -   Raw Train Losses: {Dice: 0.2928}
2025-04-24 00:19:32,575 - richard.src.train.trainer:train:158 - DEBUG -     Val Loss: 0.3404,   Val Dice: 0.6603
2025-04-24 00:19:32,575 - richard.src.train.trainer:train:161 - DEBUG -   Raw Val Losses: {Dice: 0.3404}
2025-04-24 00:19:32,575 - richard.src.train.trainer:train:163 - DEBUG - Best Val Loss So Far: 0.3375, Best Val Dice So Far: 0.6631
2025-04-24 00:20:10,549 - richard.src.train.trainer:train:140 - DEBUG - Stepped ReduceLROnPlateau scheduler with val_dice: 0.6642
2025-04-24 00:20:10,550 - richard.src.train.trainer:train:146 - DEBUG - Epoch 21: Current learning rate: 1.00e-05
2025-04-24 00:20:11,070 - richard.src.train.trainer:save_checkpoint:395 - DEBUG - Saved new best checkpoint to /radraid2/dongwoolee/VNet_LungNoduleSeg/richard/checkpoints/best_checkpoint_25-04-24_00:07:27_epoch_21.pth with val Dice: 0.6642
2025-04-24 00:20:11,101 - richard.src.train.trainer:save_checkpoint:405 - DEBUG - Removed previous best checkpoint: /radraid2/dongwoolee/VNet_LungNoduleSeg/richard/checkpoints/best_checkpoint_25-04-24_00:07:27_epoch_16.pth
2025-04-24 00:20:11,102 - richard.src.train.trainer:train:152 - DEBUG - Epoch 21 Summary:
2025-04-24 00:20:11,103 - richard.src.train.trainer:train:153 - DEBUG -   Train Loss: 0.2901, Train Dice: 0.7149
2025-04-24 00:20:11,103 - richard.src.train.trainer:train:156 - DEBUG -   Raw Train Losses: {Dice: 0.2901}
2025-04-24 00:20:11,103 - richard.src.train.trainer:train:158 - DEBUG -     Val Loss: 0.3366,   Val Dice: 0.6642
2025-04-24 00:20:11,103 - richard.src.train.trainer:train:161 - DEBUG -   Raw Val Losses: {Dice: 0.3366}
2025-04-24 00:20:11,103 - richard.src.train.trainer:train:163 - DEBUG - Best Val Loss So Far: 0.3375, Best Val Dice So Far: 0.6642
2025-04-24 00:20:47,562 - richard.src.train.trainer:train:132 - DEBUG - Epoch 22: No improvement in val_dice for 1 epoch(s). Patience: 15
2025-04-24 00:20:47,562 - richard.src.train.trainer:train:140 - DEBUG - Stepped ReduceLROnPlateau scheduler with val_dice: 0.6568
2025-04-24 00:20:47,562 - richard.src.train.trainer:train:146 - DEBUG - Epoch 22: Current learning rate: 1.00e-05
2025-04-24 00:20:47,562 - richard.src.train.trainer:save_checkpoint:409 - DEBUG - Epoch 22: Val Dice 0.6568 did not improve over best 0.6642
2025-04-24 00:20:47,562 - richard.src.train.trainer:train:152 - DEBUG - Epoch 22 Summary:
2025-04-24 00:20:47,562 - richard.src.train.trainer:train:153 - DEBUG -   Train Loss: 0.2901, Train Dice: 0.7151
2025-04-24 00:20:47,562 - richard.src.train.trainer:train:156 - DEBUG -   Raw Train Losses: {Dice: 0.2901}
2025-04-24 00:20:47,562 - richard.src.train.trainer:train:158 - DEBUG -     Val Loss: 0.3436,   Val Dice: 0.6568
2025-04-24 00:20:47,562 - richard.src.train.trainer:train:161 - DEBUG -   Raw Val Losses: {Dice: 0.3436}
2025-04-24 00:20:47,563 - richard.src.train.trainer:train:163 - DEBUG - Best Val Loss So Far: 0.3366, Best Val Dice So Far: 0.6642
2025-04-24 00:21:22,658 - richard.src.train.trainer:train:132 - DEBUG - Epoch 23: No improvement in val_dice for 2 epoch(s). Patience: 15
2025-04-24 00:21:22,658 - richard.src.train.trainer:train:140 - DEBUG - Stepped ReduceLROnPlateau scheduler with val_dice: 0.6580
2025-04-24 00:21:22,658 - richard.src.train.trainer:train:146 - DEBUG - Epoch 23: Current learning rate: 1.00e-05
2025-04-24 00:21:22,658 - richard.src.train.trainer:save_checkpoint:409 - DEBUG - Epoch 23: Val Dice 0.6580 did not improve over best 0.6642
2025-04-24 00:21:22,658 - richard.src.train.trainer:train:152 - DEBUG - Epoch 23 Summary:
2025-04-24 00:21:22,658 - richard.src.train.trainer:train:153 - DEBUG -   Train Loss: 0.2887, Train Dice: 0.7164
2025-04-24 00:21:22,658 - richard.src.train.trainer:train:156 - DEBUG -   Raw Train Losses: {Dice: 0.2887}
2025-04-24 00:21:22,659 - richard.src.train.trainer:train:158 - DEBUG -     Val Loss: 0.3430,   Val Dice: 0.6580
2025-04-24 00:21:22,659 - richard.src.train.trainer:train:161 - DEBUG -   Raw Val Losses: {Dice: 0.3430}
2025-04-24 00:21:22,659 - richard.src.train.trainer:train:163 - DEBUG - Best Val Loss So Far: 0.3366, Best Val Dice So Far: 0.6642
2025-04-24 00:21:58,835 - richard.src.train.trainer:train:132 - DEBUG - Epoch 24: No improvement in val_dice for 3 epoch(s). Patience: 15
2025-04-24 00:21:58,836 - richard.src.train.trainer:train:140 - DEBUG - Stepped ReduceLROnPlateau scheduler with val_dice: 0.6515
2025-04-24 00:21:58,836 - richard.src.train.trainer:train:146 - DEBUG - Epoch 24: Current learning rate: 1.00e-05
2025-04-24 00:21:58,836 - richard.src.train.trainer:save_checkpoint:409 - DEBUG - Epoch 24: Val Dice 0.6515 did not improve over best 0.6642
2025-04-24 00:21:58,836 - richard.src.train.trainer:train:152 - DEBUG - Epoch 24 Summary:
2025-04-24 00:21:58,836 - richard.src.train.trainer:train:153 - DEBUG -   Train Loss: 0.2852, Train Dice: 0.7197
2025-04-24 00:21:58,836 - richard.src.train.trainer:train:156 - DEBUG -   Raw Train Losses: {Dice: 0.2852}
2025-04-24 00:21:58,836 - richard.src.train.trainer:train:158 - DEBUG -     Val Loss: 0.3490,   Val Dice: 0.6515
2025-04-24 00:21:58,837 - richard.src.train.trainer:train:161 - DEBUG -   Raw Val Losses: {Dice: 0.3490}
2025-04-24 00:21:58,837 - richard.src.train.trainer:train:163 - DEBUG - Best Val Loss So Far: 0.3366, Best Val Dice So Far: 0.6642
2025-04-24 00:22:36,921 - richard.src.train.trainer:train:132 - DEBUG - Epoch 25: No improvement in val_dice for 4 epoch(s). Patience: 15
2025-04-24 00:22:36,921 - richard.src.train.trainer:train:140 - DEBUG - Stepped ReduceLROnPlateau scheduler with val_dice: 0.6464
2025-04-24 00:22:36,921 - richard.src.train.trainer:train:146 - DEBUG - Epoch 25: Current learning rate: 1.00e-05
2025-04-24 00:22:36,922 - richard.src.train.trainer:save_checkpoint:409 - DEBUG - Epoch 25: Val Dice 0.6464 did not improve over best 0.6642
2025-04-24 00:22:36,922 - richard.src.train.trainer:train:152 - DEBUG - Epoch 25 Summary:
2025-04-24 00:22:36,922 - richard.src.train.trainer:train:153 - DEBUG -   Train Loss: 0.2877, Train Dice: 0.7170
2025-04-24 00:22:36,922 - richard.src.train.trainer:train:156 - DEBUG -   Raw Train Losses: {Dice: 0.2877}
2025-04-24 00:22:36,922 - richard.src.train.trainer:train:158 - DEBUG -     Val Loss: 0.3542,   Val Dice: 0.6464
2025-04-24 00:22:36,922 - richard.src.train.trainer:train:161 - DEBUG -   Raw Val Losses: {Dice: 0.3542}
2025-04-24 00:22:36,922 - richard.src.train.trainer:train:163 - DEBUG - Best Val Loss So Far: 0.3366, Best Val Dice So Far: 0.6642
2025-04-24 00:23:14,076 - richard.src.train.trainer:train:132 - DEBUG - Epoch 26: No improvement in val_dice for 5 epoch(s). Patience: 15
2025-04-24 00:23:14,076 - richard.src.train.trainer:train:140 - DEBUG - Stepped ReduceLROnPlateau scheduler with val_dice: 0.6578
2025-04-24 00:23:14,076 - richard.src.train.trainer:train:146 - DEBUG - Epoch 26: Current learning rate: 1.00e-05
2025-04-24 00:23:14,076 - richard.src.train.trainer:save_checkpoint:409 - DEBUG - Epoch 26: Val Dice 0.6578 did not improve over best 0.6642
2025-04-24 00:23:14,076 - richard.src.train.trainer:train:152 - DEBUG - Epoch 26 Summary:
2025-04-24 00:23:14,076 - richard.src.train.trainer:train:153 - DEBUG -   Train Loss: 0.2850, Train Dice: 0.7196
2025-04-24 00:23:14,076 - richard.src.train.trainer:train:156 - DEBUG -   Raw Train Losses: {Dice: 0.2850}
2025-04-24 00:23:14,077 - richard.src.train.trainer:train:158 - DEBUG -     Val Loss: 0.3428,   Val Dice: 0.6578
2025-04-24 00:23:14,077 - richard.src.train.trainer:train:161 - DEBUG -   Raw Val Losses: {Dice: 0.3428}
2025-04-24 00:23:14,077 - richard.src.train.trainer:train:163 - DEBUG - Best Val Loss So Far: 0.3366, Best Val Dice So Far: 0.6642
2025-04-24 00:23:48,500 - richard.src.train.trainer:train:132 - DEBUG - Epoch 27: No improvement in val_dice for 6 epoch(s). Patience: 15
2025-04-24 00:23:48,500 - richard.src.train.trainer:train:140 - DEBUG - Stepped ReduceLROnPlateau scheduler with val_dice: 0.6632
2025-04-24 00:23:48,500 - richard.src.train.trainer:train:146 - DEBUG - Epoch 27: Current learning rate: 2.00e-06
2025-04-24 00:23:48,500 - richard.src.train.trainer:save_checkpoint:409 - DEBUG - Epoch 27: Val Dice 0.6632 did not improve over best 0.6642
2025-04-24 00:23:48,500 - richard.src.train.trainer:train:152 - DEBUG - Epoch 27 Summary:
2025-04-24 00:23:48,500 - richard.src.train.trainer:train:153 - DEBUG -   Train Loss: 0.2825, Train Dice: 0.7221
2025-04-24 00:23:48,501 - richard.src.train.trainer:train:156 - DEBUG -   Raw Train Losses: {Dice: 0.2825}
2025-04-24 00:23:48,501 - richard.src.train.trainer:train:158 - DEBUG -     Val Loss: 0.3376,   Val Dice: 0.6632
2025-04-24 00:23:48,501 - richard.src.train.trainer:train:161 - DEBUG -   Raw Val Losses: {Dice: 0.3376}
2025-04-24 00:23:48,501 - richard.src.train.trainer:train:163 - DEBUG - Best Val Loss So Far: 0.3366, Best Val Dice So Far: 0.6642
2025-04-24 00:24:19,882 - richard.src.train.trainer:train:132 - DEBUG - Epoch 28: No improvement in val_dice for 7 epoch(s). Patience: 15
2025-04-24 00:24:19,883 - richard.src.train.trainer:train:140 - DEBUG - Stepped ReduceLROnPlateau scheduler with val_dice: 0.6585
2025-04-24 00:24:19,883 - richard.src.train.trainer:train:146 - DEBUG - Epoch 28: Current learning rate: 2.00e-06
2025-04-24 00:24:19,883 - richard.src.train.trainer:save_checkpoint:409 - DEBUG - Epoch 28: Val Dice 0.6585 did not improve over best 0.6642
2025-04-24 00:24:19,883 - richard.src.train.trainer:train:152 - DEBUG - Epoch 28 Summary:
2025-04-24 00:24:19,883 - richard.src.train.trainer:train:153 - DEBUG -   Train Loss: 0.2810, Train Dice: 0.7231
2025-04-24 00:24:19,883 - richard.src.train.trainer:train:156 - DEBUG -   Raw Train Losses: {Dice: 0.2810}
2025-04-24 00:24:19,883 - richard.src.train.trainer:train:158 - DEBUG -     Val Loss: 0.3421,   Val Dice: 0.6585
2025-04-24 00:24:19,883 - richard.src.train.trainer:train:161 - DEBUG -   Raw Val Losses: {Dice: 0.3421}
2025-04-24 00:24:19,883 - richard.src.train.trainer:train:163 - DEBUG - Best Val Loss So Far: 0.3366, Best Val Dice So Far: 0.6642
2025-04-24 00:24:52,510 - richard.src.train.trainer:train:132 - DEBUG - Epoch 29: No improvement in val_dice for 8 epoch(s). Patience: 15
2025-04-24 00:24:52,511 - richard.src.train.trainer:train:140 - DEBUG - Stepped ReduceLROnPlateau scheduler with val_dice: 0.6558
2025-04-24 00:24:52,511 - richard.src.train.trainer:train:146 - DEBUG - Epoch 29: Current learning rate: 2.00e-06
2025-04-24 00:24:52,511 - richard.src.train.trainer:save_checkpoint:409 - DEBUG - Epoch 29: Val Dice 0.6558 did not improve over best 0.6642
2025-04-24 00:24:52,511 - richard.src.train.trainer:train:152 - DEBUG - Epoch 29 Summary:
2025-04-24 00:24:52,511 - richard.src.train.trainer:train:153 - DEBUG -   Train Loss: 0.2809, Train Dice: 0.7238
2025-04-24 00:24:52,511 - richard.src.train.trainer:train:156 - DEBUG -   Raw Train Losses: {Dice: 0.2809}
2025-04-24 00:24:52,511 - richard.src.train.trainer:train:158 - DEBUG -     Val Loss: 0.3447,   Val Dice: 0.6558
2025-04-24 00:24:52,511 - richard.src.train.trainer:train:161 - DEBUG -   Raw Val Losses: {Dice: 0.3447}
2025-04-24 00:24:52,511 - richard.src.train.trainer:train:163 - DEBUG - Best Val Loss So Far: 0.3366, Best Val Dice So Far: 0.6642
2025-04-24 00:25:21,157 - richard.src.train.trainer:train:132 - DEBUG - Epoch 30: No improvement in val_dice for 9 epoch(s). Patience: 15
2025-04-24 00:25:21,157 - richard.src.train.trainer:train:140 - DEBUG - Stepped ReduceLROnPlateau scheduler with val_dice: 0.6572
2025-04-24 00:25:21,157 - richard.src.train.trainer:train:146 - DEBUG - Epoch 30: Current learning rate: 2.00e-06
2025-04-24 00:25:21,157 - richard.src.train.trainer:save_checkpoint:409 - DEBUG - Epoch 30: Val Dice 0.6572 did not improve over best 0.6642
2025-04-24 00:25:21,157 - richard.src.train.trainer:train:152 - DEBUG - Epoch 30 Summary:
2025-04-24 00:25:21,157 - richard.src.train.trainer:train:153 - DEBUG -   Train Loss: 0.2775, Train Dice: 0.7265
2025-04-24 00:25:21,157 - richard.src.train.trainer:train:156 - DEBUG -   Raw Train Losses: {Dice: 0.2775}
2025-04-24 00:25:21,157 - richard.src.train.trainer:train:158 - DEBUG -     Val Loss: 0.3433,   Val Dice: 0.6572
2025-04-24 00:25:21,159 - richard.src.train.trainer:train:161 - DEBUG -   Raw Val Losses: {Dice: 0.3433}
2025-04-24 00:25:21,159 - richard.src.train.trainer:train:163 - DEBUG - Best Val Loss So Far: 0.3366, Best Val Dice So Far: 0.6642
2025-04-24 00:25:21,710 - richard.src.train.trainer:train:210 - INFO - Saved final checkpoint to /radraid2/dongwoolee/VNet_LungNoduleSeg/richard/checkpoints/final_checkpoint_25-04-24_00:07:27.pth
2025-04-24 00:25:21,712 - root:train:211 - INFO - Training finished.
